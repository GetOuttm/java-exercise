RocketMQ事务消息工作流程

事务消息解决的就是，事务发送方执行本地事务和事务消息的原子性。

1.首先事务发起方:往MQ中发送一个事务消息-half半消息(准备消息)，该消息不可被消费;

2.然后事务发送方执行本地事务，并发送commit给MQ，如果是执行失败就会发送rollback给MQ;

3.MQ搜到commit指令，代表本地事务执行成功，之前的half消息就会成为可以被commit提交的消 息，否则就是Rollback消息;

4.事务参与者，也就是消费者会消费这个消息，然后执行相关的逻辑处理。如果是Rollback消息就不 会被消费，而是丢弃;

5.如果事务参与方并没有发送commit或者rollback指令MQ，MQ回调用事务发送方的回到方法来检 查，我们需要去实现这个本地事务检查接口，通过返回commit或者rollback来告知MQ本地事务是 否执行成功。